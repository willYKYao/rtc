(function(e){function t(t){for(var r,s,o=t[0],u=t[1],l=t[2],h=0,d=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&d.push(i[s][0]),i[s]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);c&&c(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,o=1;o<n.length;o++){var u=n[o];0!==i[u]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={app:0},a=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var c=u;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"091d":function(e,t,n){},"13e4":function(e,t,n){"use strict";n("7d9e")},"56d7":function(e,t,n){"use strict";n.r(t);var r=n("2b0e"),i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},a=[],s={name:"App",mounted(){}},o=s,u=(n("13e4"),n("2877")),l=Object(u["a"])(o,i,a,!1,null,null,null),c=l.exports,h=n("8c4f"),d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login flex"},[t("div",{staticClass:"main"},[e._m(0),t("div",{staticClass:"main-input"},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.userName,expression:"userName",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入用户名"},domProps:{value:e.userName},on:{input:function(t){t.target.composing||(e.userName=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),t("br"),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.channelId,expression:"channelId",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入房间号"},domProps:{value:e.channelId},on:{input:function(t){t.target.composing||(e.channelId=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),t("div",{staticClass:"main-button"},[t("button",{attrs:{type:"button",disabled:""===e.channelId||!e.isSupportRtc},on:{click:e.handleClickJoinBtn}},[e._v(" 进入房间 ")])])])])},p=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-title"},[t("span",[e._v("音视频通信")])])}];function f(e,t){return t>>>e|t<<32-e}function m(e,t,n){return e&t^~e&n}function v(e,t,n){return e&t^e&n^t&n}function b(e){return f(2,e)^f(13,e)^f(22,e)}function g(e){return f(6,e)^f(11,e)^f(25,e)}function x(e){return f(7,e)^f(18,e)^e>>>3}function y(e){return f(17,e)^f(19,e)^e>>>10}function C(e,t){return e[15&t]+=y(e[t+14&15])+e[t+9&15]+x(e[t+1&15])}var _,I,w,A=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),O="0123456789abcdef";function $(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function k(){_=new Array(8),I=new Array(2),w=new Array(64),I[0]=I[1]=0,_[0]=1779033703,_[1]=3144134277,_[2]=1013904242,_[3]=2773480762,_[4]=1359893119,_[5]=2600822924,_[6]=528734635,_[7]=1541459225}function P(){var e,t,n,r,i,a,s,o,u,l,c=new Array(16);e=_[0],t=_[1],n=_[2],r=_[3],i=_[4],a=_[5],s=_[6],o=_[7];for(var h=0;h<16;h++)c[h]=w[3+(h<<2)]|w[2+(h<<2)]<<8|w[1+(h<<2)]<<16|w[h<<2]<<24;for(var d=0;d<64;d++)u=o+g(i)+m(i,a,s)+A[d],u+=d<16?c[d]:C(c,d),l=b(e)+v(e,t,n),o=s,s=a,a=i,i=$(r,u),r=n,n=t,t=e,e=$(u,l);_[0]+=e,_[1]+=t,_[2]+=n,_[3]+=r,_[4]+=i,_[5]+=a,_[6]+=s,_[7]+=o}function j(e,t){var n,r,i=0;r=I[0]>>3&63;var a=63&t;for((I[0]+=t<<3)<t<<3&&I[1]++,I[1]+=t>>29,n=0;n+63<t;n+=64){for(var s=r;s<64;s++)w[s]=e.charCodeAt(i++);P(),r=0}for(s=0;s<a;s++)w[s]=e.charCodeAt(i++)}function S(){var e=I[0]>>3&63;if(w[e++]=128,e<=56)for(var t=e;t<56;t++)w[t]=0;else{for(t=e;t<64;t++)w[t]=0;P();for(t=0;t<56;t++)w[t]=0}w[56]=I[1]>>>24&255,w[57]=I[1]>>>16&255,w[58]=I[1]>>>8&255,w[59]=255&I[1],w[60]=I[0]>>>24&255,w[61]=I[0]>>>16&255,w[62]=I[0]>>>8&255,w[63]=255&I[0],P()}function N(){for(var e=new String,t=0;t<8;t++)for(var n=28;n>=0;n-=4)e+=O.charAt(_[t]>>>n&15);return e}function R(e){return k(),j(e,e.length),S(),N()}var W={name:"Login",data(){return{isSupportRtc:!1,userName:Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5),channelId:"",userId:""}},methods:{handleClickJoinBtn(){const e=this.getAuthInfo();this.joinChannel(e)},joinChannel(e){this.$aliWebrtc.joinChannel(e,this.userName).then(()=>{this.$router.push({path:"/metting",query:{channelId:this.channelId,userName:this.userName,userId:this.userId}})},e=>{alert("joinChannel err: "+e.message)})},getAuthInfo(){const e="hil6ydzc",t="8172773aeb6531f8fb9efd5162e6a08c",n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)}));this.userId=n;const r=parseInt((new Date).getTime()/1e3+172800),i="AK-"+r,a=R(e+t+this.channelId+n+i+r);return{appid:e,userid:n,timestamp:r,nonce:i,token:a,gslb:["https://rgslb.rtc.aliyuncs.com"],channel:this.channelId}},checkSupportRtc(){this.$aliWebrtc.isSupport().then(e=>{console.log(e),this.isSupportRtc=!0}).catch(e=>{alert("support err: "+e.message),this.isSupportRtc=!1})}},created(){this.checkSupportRtc()}},B=W,V=(n("607a"),Object(u["a"])(B,d,p,!1,null,"074d0536",null)),L=V.exports,M=function(){var e=this,t=e._self._c;return t("div",{staticClass:"metting flex"},[e._m(0),t("div",{staticClass:"local-container"},[t("div",{staticClass:"local-message"},[t("p",[e._v(" User: "),t("strong",[e._v(e._s(e.userName))])]),t("p",[e._v(" Channel Id: "),t("strong",[e._v(e._s(e.channelId))])]),t("button",{class:e.isOpenCamera?"active":"",attrs:{type:"button"},on:{click:e.handleClickCameraBtn}},[e._v(" 关闭摄像头 ")]),t("button",{class:e.isOpenAudio?"active":"",attrs:{type:"button"},on:{click:e.handleClickAudioBtn}},[e._v(" 关闭麦克风 ")]),t("button",{attrs:{type:"button"},on:{click:e.handleClickLeaveBtn}},[e._v("退出房间")])]),t("div",{staticClass:"local-video"},[t("video",{ref:"localVideo",attrs:{autoplay:""}})])]),t("div",{staticClass:"remote-container"},[t("h2",[e._v("房间成员")]),t("ul",e._l(e.remotes,(function(n){return t("li",{key:n.userId},[t("video",{ref:"remote"+n.userId,refInFor:!0,attrs:{autoplay:""},domProps:{muted:n.muteAudioPlaying}}),t("div",{staticClass:"remote-name"},[e._v(e._s(n.displayName))]),t("button",{class:n.muteAudioPlaying?"":"active",attrs:{type:"button"},on:{click:function(t){return e.handleClickRemoteAudioBtn(n.userId,!n.muteAudioPlaying)}}},[e._v(" 静音 ")])])})),0)])])},J=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"sideBar"},[t("h2",{staticClass:"logo"},[t("a",{attrs:{href:"/"}})])])}],U={name:"Metting",data(){return{channelId:"",userName:"",userId:"",isOpenCamera:!0,isOpenAudio:!0,remotes:this.$aliWebrtc.getUserList()}},methods:{handleClickLeaveBtn(){this.leaveChannel()},handleClickCameraBtn(){this.$aliWebrtc.configLocalCameraPublish=!this.isOpenCamera,this.publishVideo(!this.isOpenCamera,this.isOpenAudio)},handleClickAudioBtn(){this.$aliWebrtc.configLocalAudioPublish=!this.isOpenAudio,this.publishVideo(this.isOpenCamera,!this.isOpenAudio)},handleClickRemoteAudioBtn(e,t){this.$aliWebrtc.muteRemoteAudioPlaying(e,t);const n=this.$aliWebrtc.getUserInfo(e);this.remotes.map((t,r)=>{t.userId===e&&this.remotes.splice(r,1,n)})},leaveChannel(){this.$aliWebrtc.leaveChannel().then(()=>{console.log("退出成功"),this.$router.replace({path:"/"}),location.reload()},e=>{alert("leaveChannel err: "+e.message)})},init(){this.$aliWebrtc.on("onJoin",e=>{this.remotes.push(e),this.subscribeRemote(e.userId)})},showLocalVideo(){console.log(this.$refs.localVideo),this.$aliWebrtc.startPreview(this.$refs.localVideo).then(()=>{console.log("预览成功")}).catch(e=>{alert("startPreview err: "+e.message)})},publishVideo(e,t){this.$aliWebrtc.publish().then(()=>{console.log("推流成功"),this.isOpenCamera=e,this.isOpenAudio=t},e=>{alert("publish err: "+e.message)})},subscribeRemote(e){this.$aliWebrtc.subscribe(e).then(e=>{this.$aliWebrtc.setDisplayRemoteVideo(e,this.$refs["remote"+e][0],1)},e=>{alert("subscribe err: "+e.message)})}},created(){const{channelId:e,userName:t,userId:n}=this.$route.query;this.userName=t,this.userId=n,this.channelId=e},mounted(){this.init(),this.showLocalVideo(),this.publishVideo(this.isOpenCamera,this.isOpenAudio),this.remotes.map(e=>{this.subscribeRemote(e.userId)})},beforeDestroy(){this.leaveChannel()}},T=U,D=(n("9f54"),Object(u["a"])(T,M,J,!1,null,"2b44b674",null)),q=D.exports,z=new h["a"]({routes:[{path:"/",component:L},{path:"/metting",component:q}]});n("d4f7");r["a"].config.productionTip=!1,r["a"].use(h["a"]),new r["a"]({render:e=>e(c),router:z,beforeCreate(){r["a"].prototype.$aliWebrtc=new window.AliRtcEngine({autoPublish:!0,autoSubscribe:!0})}}).$mount("#app")},"607a":function(e,t,n){"use strict";n("091d")},"7d9e":function(e,t,n){},"9f54":function(e,t,n){"use strict";n("a3f0")},a3f0:function(e,t,n){}});
//# sourceMappingURL=app.29dc7860.js.map